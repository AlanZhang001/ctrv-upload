{"version":3,"sources":["webpack:///webpack/bootstrap b54a17caabf074412f47","webpack:///./ctrlVMain.js","webpack:///../index.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;ACtCA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;AAED;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,EAAC;;AAED;;;;;;;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD,qCAAoC;AACpC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;;AAEA,kGAAiG;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,GAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,6CAA4C;AAC5C;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAU;;AAEV;AACA;AACA,WAAU;;AAEV;AACA;AACA;AACA,WAAU;;AAEV;AACA;AACA;AACA,WAAU;;AAEV;;AAEA;AACA;AACA,kBAAiB,OAAO;AACxB,kBAAiB,OAAO;AACxB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB,QAAQ;AACzB;AACA;AACA;;AAEA;AACA,oDAAmD,SAAS,UAAU,aAAa,WAAW,UAAU,UAAU,eAAe,WAAW;;AAE5I;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kBAAiB,MAAM;AACvB,kBAAiB,OAAO;AACxB;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,mBAAkB;;AAElB,eAAc;;AAEd;;AAEA;;AAEA;AACA;AACA,WAAU;;AAEV;AACA;;AAEA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;;AAEA,eAAc;AACd;;;AAGA;;AAEA;AACA;AACA,kBAAiB,OAAO;AACxB,kBAAiB,OAAO;AACxB;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,8EAA6E;;AAE7E;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAE;;;;;;AAMF;AACA;AACA,EAAC;AACD,E","file":"ctrlVMain.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap b54a17caabf074412f47\n **/","var ctrlV = require(\"../index.js\");\r\n\r\nvar $imgList = document.querySelector(\".imgList\");\r\n\r\nvar load1 = document.querySelector(\".js-upload\");\r\nvar load2 = document.querySelector(\".js-upload2\");\r\n\r\nnew ctrlV({\r\n    uploadUrl: \"server.php\",\r\n    targetElement: load1,\r\n    data:{\r\n        name:\"alanzhang\"\r\n    },\r\n    success:function(data){\r\n        alert(\"上传成功\");\r\n        console.log(data);\r\n\r\n        var $li  = document.createElement(\"li\");\r\n        var $img = document.createElement(\"img\");\r\n        $img.src = data.link;\r\n        $li.appendChild($img);\r\n        $imgList.appendChild($li);\r\n    }\r\n});\r\n\r\nnew ctrlV({\r\n    uploadUrl: \"server2.php\",\r\n    targetElement: load2,\r\n    data:{\r\n        name:\"alanzhang\"\r\n    },\r\n    success:function(data){\r\n        console.log(data);\r\n    }\r\n});\r\n\r\nload1 = load2 = null;\r\n\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./ctrlVMain.js\n ** module id = 1\n ** module chunks = 0\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ctrlVUtil\"] = factory();\n\telse\n\t\troot[\"ctrlVUtil\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/*!\r\n\t *\r\n\t * @author: diandian & alanzhang\r\n\t * @date: 2016/8/19\r\n\t * @overview: [截屏后，按粘贴快捷键ctrl+v上传，]\r\n\t * @兼容性说明： IE11，Firefox，chrome\r\n\t *\r\n\t */\r\n\r\n\r\n\t'use strict';\r\n\r\n\t(function(root, factory){\r\n\t    if (true) {\r\n\t        // AMD\r\n\t        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\r\n\t    } else if (typeof exports === 'object') {\r\n\t        // Node, CommonJS-like\r\n\t        module.exports = factory();\r\n\t    } else {\r\n\t        // Browser globals (root is window)\r\n\t        root.ctrlVUtil = factory();\r\n\t    }\r\n\t}(this, function(){\r\n\r\n\t    function ctrlVUtil(option){\r\n\r\n\t        // 鼠标在该元素上，使用ctrl+v键时上传\r\n\t        this.targetElement = null;\r\n\r\n\t        // 用于响应paste事件的元素，如果页面不传递，则创建该元素，并位于targetElement前面\r\n\t        this.uploadInput = null;\r\n\r\n\t        // 默认的上传地址\r\n\t        this.uploadUrl = \"http://www.oa.com/screenshot/create-file\";\r\n\r\n\t        // 对于读取的图片base64，前缀为data:image/jpg;base64,base64content\r\n\t        // isCompleteImg为false则去掉前缀直接上传内容部分，为true则上传完整的base64字符串\r\n\t        this.isCompleteImg = false;\r\n\r\n\t        var that = this;\r\n\r\n\t        // 合并参数\r\n\t        that.mixinConfig(option);\r\n\r\n\t        // 鼠标移入和点击时上传，移出时失焦\r\n\t        that.targetElement.addEventListener(\"mouseover\", function() {\r\n\t            that.uploadInput.focus();\r\n\t        });\r\n\r\n\t        that.targetElement.addEventListener(\"click\", function() {\r\n\t            that.uploadInput.focus();\r\n\t        });\r\n\r\n\t        // 移除鼠标则input失去交掉\r\n\t        that.targetElement.addEventListener(\"mouseleave\", function() {\r\n\t            that.uploadInput.blur();\r\n\t        });\r\n\r\n\t        // 监听paste的事件\r\n\t        that.uploadInput.addEventListener('paste', function(e) {\r\n\t            that.handlePaste(e);\r\n\t        });\r\n\r\n\t    }\r\n\r\n\t    /**\r\n\t     * [mixinConfig 整合参数]\r\n\t     * @param  {[type]} option [description]\r\n\t     * @return {[type]}        [description]\r\n\t     */\r\n\t    ctrlVUtil.prototype.mixinConfig = function(option){\r\n\t        this.targetElement = option.targetElement || document.querySelector(\".js-upload\");\r\n\t        this.uploadInput =  this.createInputTarget();\r\n\r\n\t        this.isCompleteImg = \"isCompleteImg\" in option ? option.isCompleteImg : this.isCompleteImg;\r\n\r\n\t        // 上传地址\r\n\t        this.uploadUrl = option.uploadUrl || this.uploadUrl;\r\n\r\n\t        // 除了图片内容以外的其他数据\r\n\t        this.data = option.data;\r\n\r\n\t        // 上传成功时的回调函数\r\n\t        this.success = option.success || function(data) {\r\n\t            console.log(data);\r\n\t        };\r\n\r\n\t        // 上传失败时的回调函数\r\n\t        this.error = option.error || function(error) {\r\n\t            console.log(error);\r\n\t        };\r\n\t    };\r\n\r\n\t    /**\r\n\t     * [createInputTarget 创建div元素，用于响应paste事件]\r\n\t     * @return {Element} [description]\r\n\t     */\r\n\t    ctrlVUtil.prototype.createInputTarget = function() {\r\n\t        var imgContinaer = document.createElement(\"div\");\r\n\r\n\t        // 使其不可见\r\n\t        imgContinaer.style.cssText = \"border:none;margin:0;padding:0;font-size: 0;height:1px;width:1px;opacity:0;position:fixed;z-index:-1;\";\r\n\r\n\t        // 让其可编辑，能响应paste事件\r\n\t        imgContinaer.contentEditable = true;\r\n\t        imgContinaer.class = \"ui-ctrlv-uploadInput\";\r\n\r\n\t        // 插入targeElementn前面\r\n\t        this.targetElement.parentNode.insertBefore(imgContinaer, this.targetElement);\r\n\r\n\t        return imgContinaer;\r\n\t    };\r\n\r\n\t    /**\r\n\t     * [handlePaste 处理粘贴行为]\r\n\t     * @param  {Event} e [粘贴事件]\r\n\t     * @return {[type]}   [description]\r\n\t     */\r\n\t    ctrlVUtil.prototype.handlePaste = function(e){\r\n\r\n\t        var that = this;\r\n\r\n\t        // webkit 内核支持items方法\r\n\t        if (e && e.clipboardData && e.clipboardData.items) {\r\n\r\n\t            // 获取item\r\n\t            var item = e.clipboardData.items[0],\r\n\t                that = this;\r\n\r\n\t            if (item.type.indexOf('image') != -1) {\r\n\r\n\t                var blob = item.getAsFile();\r\n\r\n\t                // 创建读取对象\r\n\t                var fileReader = new FileReader();\r\n\r\n\t                // 将文件读取为字符串\r\n\t                fileReader.readAsDataURL(blob);\r\n\r\n\t                fileReader.addEventListener('load', function(e) {\r\n\t                    var file = e.target.result;\r\n\t                    that.send(file);\r\n\t                }, false);\r\n\r\n\t            } else {\r\n\r\n\t                that.alertMsg(\"请粘贴image类型\");\r\n\r\n\t            }\r\n\r\n\t        // firefox无法使用items方法，在粘贴时，图片会作为img标签插入targetElement中，\r\n\t        // 获取img标签的src内容进行上传\r\n\t        } else {\r\n\r\n\t            setTimeout(function() {\r\n\t                var $img = that.uploadInput.querySelector(\"img\");\r\n\r\n\t                if ($img) {\r\n\t                    that.send($img.src);\r\n\t                } else {\r\n\t                    that.alertMsg(\"浏览器不支持剪贴板操作\");\r\n\t                    return;\r\n\t                }\r\n\r\n\t            }, 200);\r\n\t        }\r\n\r\n\r\n\t    };\r\n\r\n\t    /**\r\n\t     * [send 上传图片]\r\n\t     * @param  {string} imgcontent [图片内容base64格式]\r\n\t     * @return {[type]}            [description]\r\n\t     */\r\n\t    ctrlVUtil.prototype.send = function(imgcontent) {\r\n\t        var that = this;\r\n\r\n\t        that.uploadInput.innerHTML = \"\";\r\n\r\n\t        var data = that.data || {};\r\n\r\n\t        // 根据sCompleteImg来决定上传的是整体的base64字符串还是仅仅为内容部分\r\n\t        data.content = this.isCompleteImg ? imgcontent : imgcontent.split(';')[1].split(',')[1];\r\n\r\n\t        var xhr = new XMLHttpRequest();\r\n\r\n\t        xhr.open(\"post\",that.uploadUrl,true);\r\n\r\n\t        xhr.onreadystatechange = function(e) {\r\n\t            if (xhr.readyState == 4) {\r\n\t                if (xhr.status == 200) {\r\n\t                    var ret = JSON.parse(xhr.responseText);\r\n\t                    that.success && that.success(ret);\r\n\t                } else {\r\n\t                    that.error && that.error(e, xhr);\r\n\t                }\r\n\t            }\r\n\t        };\r\n\r\n\t        xhr.onerror = function(e) {\r\n\t            that.error && that.error(e, xhr);\r\n\t        };\r\n\r\n\t        xhr.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\r\n\r\n\t        var dataString = [];\r\n\r\n\t        for(var key in data){\r\n\t            dataString.push(key+\"=\"+encodeURIComponent(data[key]));\r\n\t        }\r\n\r\n\t        xhr.send(dataString.join(\"&\"));\r\n\t    };\r\n\r\n\t    ctrlVUtil.prototype.alertMsg = function(content){\r\n\t        alert(content);\r\n\t    }\r\n\r\n\t    // 暴露构造函数\r\n\t    return ctrlVUtil;\r\n\t}));\r\n\r\n\r\n\r\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ../index.js\n ** module id = 2\n ** module chunks = 0\n **/"],"sourceRoot":""}